# Классификация изображений: Cats vs Dogs

## Описание задачи

Данный проект посвящен обучению модели классификации изображений для различения кошек и собак. 
Задача решается на основе данных, предоставленных в рамках соревнования "Cats vs Dogs" на платформе Kaggle.

**Цель:** Создать модель, способную с высокой точностью определять, изображена ли на фотографии кошка или собака.

**Метрика оценки:** Log Loss. Целевое значение метрики: Log Loss < 0.3.

## Данные

Исходные данные состоят из двух zip-архивов:

*   `train.zip`: Содержит изображения для обучения модели, разделенные по классам (кошки и собаки).
*   `test.zip`: Содержит изображения для обучения модели, разделенные по классам (кошки и собаки).

## Архитектура решения

1.  **Подготовка данных:**
    *   Распаковка архивов `train.zip` и `test.zip`.
    *   Создание DataFrame для тренировочных данных, содержащего имена файлов и соответствующие метки (cat/dog).
    *   Разделение тренировочных данных на обучающую и валидационную выборки (80% - обучение, 20% - валидация).
    *   Использование `ImageDataGenerator` для аугментации обучающих данных (повороты, сдвиги, изменение яркости, масштабирование, горизонтальные отражения) с целью увеличения разнообразия данных и улучшения обобщающей способности модели. Для валидационных и тестовых данных применяется только рескейлинг.

2.  **Модель:**
    *   Использование предобученной модели `MobileNetV2` в качестве базовой.  Предобученные веса `imagenet` используются для инициализации модели.
    *   Замораживание большей части слоев `MobileNetV2` и размораживание только последних 30 слоев для fine-tuning.
    *   Добавление слоев `GlobalAveragePooling2D`, `BatchNormalization`, `Dense` (ReLU активация, L2 регуляризация), `Dropout` и выходного `Dense` слоя (Sigmoid активация, L2 регуляризация) поверх базовой модели.

3.  **Обучение:**
    *   Использование `BinaryCrossentropy` с `label_smoothing` в качестве функции потерь. Label smoothing помогает стабилизировать предсказания модели.
    *   Применение `CosineDecay` scheduler для адаптации скорости обучения.  Уменьшение скорости обучения по косинусоидальному закону позволяет более точно настроить веса модели.
    *   Оптимизатор `Adam` для минимизации функции потерь.
    *   Использование `EarlyStopping` callback для предотвращения переобучения.  Обучение останавливается, если метрика валидации (val_loss) не улучшается в течение заданного количества эпох (patience=7).  В таком случае, восстанавливаются лучшие веса модели.

4.  **Test-Time Augmentation (TTA):**
    *   Применение TTA для повышения устойчивости и точности предсказаний.  Для каждого изображения из валидационной выборки делается несколько предсказаний (n\_aug=10) с различными аугментациями.  Итоговое предсказание вычисляется как среднее арифметическое всех предсказаний.
    *   Оценка модели на валидационной выборке с использованием TTA и вычисление метрики Log Loss.

5.  **Подготовка файла для Kaggle:**
    *   Создание DataFrame для тестовых данных, содержащего имена файлов.
    *   Использование `ImageDataGenerator` для рескейлинга тестовых изображений.
    *   Предсказание классов для тестовых изображений с использованием обученной модели.
    *   Формирование DataFrame `submission.csv` с идентификаторами изображений и соответствующими вероятностями класса "dog".
    *   Сохранение DataFrame в файл `submission.csv`.

## Результаты

**Log Loss (Kaggle Leaderboard): 0.09172**

## Файл Submission.csv

**Файл `submission.csv` был успешно создан и содержит предсказания модели для тестовых изображений в формате, требуемом для отправки на Kaggle.**

## Выводы

Обученная модель достигла нужного результата на Leaderboard Kaggle, показав значение Log Loss **0.09172**. Использование предобученной модели MobileNetV2, аугментации данных, регуляризации, CosineDecay scheduler, EarlyStopping и TTA оказалось эффективным для решения задачи классификации кошек и собак с высокой точностью.  Результат значительно превосходит целевое значение Log Loss < 0.3, демонстрируя высокое качество разработанного решения.